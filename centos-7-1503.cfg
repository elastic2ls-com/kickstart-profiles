#Generated by Kickstart Configurator
#platform=AMD64 or Intel EM64T

#LANGUAGE AND TIMEZONE
lang de_DE
#Centos meckert über langsupport!!
#langsupport de_DE
#Centos meckert über System!!
#System keyboard
keyboard de
timezone Europe/Berlin
selinux --disabled

#System mouse
#Centos meckert auch über mouse!!
#mouse

#USERS
auth  --useshadow  --enablemd5
rootpw --iscrypted $1$ipo4.ufM$jp6uu4ipYcXdv.wVpGM270

#Centos meckert auch über --fullname!!!
#user eladmin --fullname "eladmin" --iscrypted --password $1$.1XtaB/x$CIODLDjRhxBEM1TTYRcIk1
user --name=eladmin --iscrypted --password $1$.1XtaB/x$CIODLDjRhxBEM1TTYRcIk1 --groups=wheel



#Reboot after installation
reboot
text
install

#Use Web installation
#url --url http://172.28.128.11/ubuntu/15/amd64/
#Muss explizit angegeben werden bei Centos Installation!!
url --url http://mirror.netcologne.de/centos/7.1.1503/os/x86_64/

#BOOTLOADER AND PARTITIONING
bootloader --location=mbr 
#Centos meckert darüber das zerombr kein Argument akzeptiert!!
#zerombr yes
zerombr
clearpart --all --initlabel
 
part /boot --fstype ext4 --size=128
part pv.01 --size=0 --grow
volgroup vg0 pv.01
logvol swap --fstype swap --name=swap --vgname=vg0 --recommended
logvol / --fstype ext4 --name=root --vgname=vg0 --size=10480 --grow
logvol /home --fstype ext4 --name=home --vgname=vg0 --size=8096

#NETWORK
#Statisches Netzwerk geht nicht wird aber für x2go gebraucht.
#network --bootproto=static --ip 172.28.128.12 --netmask 255.255.255.0 --gateway 172.28.128.1  --nameserver=8.8.8.8 --hostname=kickstart-1 --device=eth0 --noipv6
network --bootproto=dhcp --device=enp0s3 --nameserver=8.8.8.8 --noipv6
firewall --disabled 
skipx

%packages
openssh-server
#puppet
coreutils
curl
screen
#@gnome-desktop
#Möglciherweise der Fehlerkandidat
#xcfe
#@ubuntu-desktop
#@ubuntu-standard

#Centos will ein %end nach %packages!!!
%end

##TODO kickstart vs. Puppet
#Hostname dynamisch setzen lassen?
#sudo rechte für eladmin
#enable root login in /etc/ssh/sshd_config
#manipulate /etc/motd


%post
#Grant the user eladmin sudo rights
sed -i 's/^wheel:x:10:/wheel:x:10:eladmin/' /etc/group

#Install X2GO for Remote X11 access via SSH
#apt-get install software-properties-common -y
#add-apt-repository ppa:x2go/stable -y 
#apt-get update
#apt-get install x2goserver x2goserver-xsession -y

#grant root login via ssh for testservers only
sed -i 's/^#PermitRootLogin yes/PermitRootLogin yes/' /etc/ssh/sshd_config
service sshd restart
%end
